---
import BaseHead from '../components/BaseHead.astro';
import { Image } from 'astro:assets';
import logoImg from '../assets/images/logo-main.png';
import '../styles/global.css';
import { getLangFromUrl, useTranslations } from '../i18n/utils';
import LanguagePicker from '../components/LanguagePicker.astro';


interface Props {
	title: string;
	description: string;
    useMainContainer?: boolean;
}

const { title, description, useMainContainer = true } = Astro.props;
const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);

// Helper for nav links to prepend lang if not default
const localizePath = (path: string) => {
    if (lang === 'es') return path;
    // ensure path starts with /
    const p = path.startsWith('/') ? path : `/${path}`;
    return `/${lang}${p}`;
};
---

<!doctype html>
<html lang={lang} class="scroll-smooth">
	<head>
		<BaseHead title={title} description={description} />
	</head>
	<body class="bg-stone-50 text-stone-800 font-sans antialiased min-h-screen flex flex-col">
		<header class="bg-stone-100/90 backdrop-blur-sm border-b border-stone-200 sticky top-0 z-50 transition-all duration-300">
			<div class="container mx-auto px-4 h-24 flex items-center justify-between relative">
				<!-- Mobile Menu Button (Left) -->
				<button id="menu-toggle" class="min-[1400px]:hidden p-2 text-stone-600 hover:text-clay-dark focus:outline-none z-20" aria-label="Abrir menÃº">
					<svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor">
						<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
					</svg>
				</button>
                
                <!-- Logo (Center) -->
				<a href={localizePath('/')} class="absolute left-1/2 top-1/2 transform -translate-x-1/2 -translate-y-1/2 flex items-center gap-3 group z-10 w-fit">
					<Image 
						src={logoImg} 
						alt="Anthropos Logo" 
						class="h-16 w-auto group-hover:opacity-90 transition-opacity" 
						loading="eager"
						height={128}
						format="webp"
					/>
				</a>

				<div class="flex-1 hidden min-[1400px]:flex justify-end gap-6 items-center">
					<nav class="flex gap-6 items-center">
						<a href={localizePath('/educacion')} class="text-stone-600 hover:text-clay-dark font-medium transition-colors text-base lg:text-lg">{t('nav.education')}</a>
						<a href={localizePath('/campamento-arqueologia')} class="text-stone-600 hover:text-clay-dark font-medium transition-colors text-base lg:text-lg">{t('nav.camping')}</a>
						<a href={localizePath('/museos')} class="text-stone-600 hover:text-clay-dark font-medium transition-colors text-base lg:text-lg">{t('nav.museums')}</a>
						<a href={localizePath('/contacto')} class="text-stone-600 hover:text-clay-dark font-medium transition-colors text-base lg:text-lg">{t('nav.contact')}</a>
					</nav>
					<div class="hidden min-[1400px]:block">
						<LanguagePicker />
					</div>
				</div>
			</div>

			<!-- Mobile Menu Panel -->
			<div id="mobile-menu" class="hidden min-[1400px]:hidden bg-stone-100 border-t border-stone-200 absolute w-full left-0 top-24 z-40">
				<nav class="flex flex-col p-4 gap-4 text-center">
					<a href={localizePath('/educacion')} class="text-stone-600 hover:text-clay-dark font-medium py-2 text-lg">{t('nav.education')}</a>
					<a href={localizePath('/campamento-arqueologia')} class="text-stone-600 hover:text-clay-dark font-medium py-2 text-lg">{t('nav.camping')}</a>
					<a href={localizePath('/museos')} class="text-stone-600 hover:text-clay-dark font-medium py-2 text-lg">{t('nav.museums')}</a>
					<a href={localizePath('/contacto')} class="text-stone-600 hover:text-clay-dark font-medium py-2 text-lg">{t('nav.contact')}</a>
                    <div class="pt-4 border-t border-stone-200 w-full flex justify-center">
                        <LanguagePicker />
                    </div>
				</nav>
			</div>
		</header>

		<main class={`flex-grow ${useMainContainer ? 'container mx-auto px-4 py-8 md:py-12' : ''}`}>
			<slot />
		</main>

		<footer class="bg-stone-900 text-stone-400 py-12 mt-auto">
			<div class="container mx-auto px-4 grid md:grid-cols-3 gap-8">
				<div>
					<h3 class="text-stone-200 font-serif font-bold text-xl mb-4">PEDRATALLADA</h3>
					<p class="text-sm leading-relaxed">
						{t('footer.desc')}
					</p>
				</div>
				<div>
					<h4 class="text-stone-200 font-bold mb-4">{t('footer.services')}</h4> <!-- Simplified for now -->
					<ul class="space-y-2 text-sm">
						<li><a href={localizePath('/nosotros')} class="hover:text-stone-200 transition-colors">{t('footer.about')}</a></li>
						<li><a href={localizePath('/servicios')} class="hover:text-stone-200 transition-colors">{t('footer.services')}</a></li>
						<li><a href={localizePath('/politica-privacidad')} class="hover:text-stone-200 transition-colors">{t('footer.privacy')}</a></li>
					</ul>
				</div>
				<div>
					<h4 class="text-stone-200 font-bold mb-4">{t('nav.contact')}</h4>
					<p class="text-sm">info@pedratallada.com</p>
					<div class="flex gap-4 mt-4">
						<a href="https://www.facebook.com/profile.php?id=100093317785372&locale=es_ES" target="_blank" rel="noopener noreferrer" class="w-10 h-10 bg-stone-800 rounded-full flex items-center justify-center text-stone-400 hover:text-white hover:bg-clay-dark transition-all duration-300" aria-label="Facebook">
							<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
								<path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"></path>
							</svg>
						</a>
						<a href="https://www.instagram.com/pedra_tallada/" target="_blank" rel="noopener noreferrer" class="w-10 h-10 bg-stone-800 rounded-full flex items-center justify-center text-stone-400 hover:text-white hover:bg-clay-dark transition-all duration-300" aria-label="Instagram">
							<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
								<rect x="2" y="2" width="20" height="20" rx="5" ry="5"></rect>
								<path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"></path>
								<line x1="17.5" y1="6.5" x2="17.51" y2="6.5"></line>
							</svg>
						</a>
						<a href="https://www.researchgate.net/profile/Juan-Pablo-Donadei/research" target="_blank" rel="noopener noreferrer" class="w-10 h-10 bg-stone-800 rounded-full flex items-center justify-center text-stone-400 hover:text-white hover:bg-clay-dark transition-all duration-300" aria-label="ResearchGate">
                            <!-- Simple generic Science/Academic icon for ResearchGate as a specific simple SVG is hard to find standard -->
							<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M22 6c0-1.1-.9-2-2-2H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6z"></path>
                                <path d="M12 14l9-5-9-5-9 5 9 5z"></path>
                                <path d="M12 14l6.16-3.422a12.083 12.083 0 0 1 .665 6.479A11.952 11.952 0 0 0 12 20.055a11.952 11.952 0 0 0-6.824-2.998 12.078 12.078 0 0 1 .665-6.479L12 14z"></path>
                            </svg>
						</a>
					</div>
				</div>
			</div>
			<div class="container mx-auto px-4 mt-8 pt-8 border-t border-stone-800 text-center text-xs">
				&copy; {new Date().getFullYear()} Pedra Tallada. {t('footer.rights')}
			</div>
		</footer>

		<script>
			// Mobile Menu Logic
			const menuToggle = document.getElementById('menu-toggle');
			const mobileMenu = document.getElementById('mobile-menu');

			if (menuToggle && mobileMenu) {
				menuToggle.addEventListener('click', () => {
					mobileMenu.classList.toggle('hidden');
				});
			}
		</script>
	</body>
</html>
